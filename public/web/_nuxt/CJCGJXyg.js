import{u as O,_ as K}from"./Y0bsS6zN.js";import{_ as Y}from"./DK2Ta0V0.js";import{_ as Z}from"./BDptti_i.js";import{d as H,aY as W,b as X,g as C,s as p,aZ as ee,i as te,c as S,q as s,l as I,z as F,p as e,t as d,v as l,k as N,A as j,F as oe,B as se,j as k,C as ne,a_ as ae,o as i,_ as ie,n as re,x as $,ap as le,aq as ce,aL as me,an as ue}from"#entry";import{_ as pe}from"./C9uAuRV7.js";import{d as de,e as fe,f as _e}from"./B1XcE43x.js";import{u as he}from"./C1DLXs69.js";import"./--UdezPG.js";import"./BYwSSEjb.js";import"./BgHJjJs-.js";import"./ByDcNyZR.js";import"./CqTMLIrD.js";import"./8-c-A7PB.js";import"./kRIii9yh.js";import"./Y5xxW4ru.js";import"./Cfcu-t3n.js";import"./C6Y-ieo6.js";import"./b-_TUx9i.js";import"./DaNf1Wdt.js";import"./CKXZhss7.js";import"./Cpt2kRVT.js";import"./pUN2d83w.js";import"./B22A-h4k.js";import"./Bub1HYiY.js";import"./lw_U4-W2.js";import"./XpsTG8vq.js";import"./BsoAYZfI.js";import"./B3ZBHMjU.js";import"./Dn8X9Gvz.js";import"./DlAUqK2U.js";import"./D_xVtNgx.js";import"./DSMB-qMT.js";import"./B128ot1i.js";import"./CoMGTw2w.js";import"./eeyg4-1U.js";import"./B93AZ-4h.js";import"./CP4Zo7YT.js";import"./CBooyAK7.js";import"./PM3E-asR.js";import"./CFdZ4x-w.js";import"./CbuHra-u.js";import"./9bDOsXij.js";import"./D9F45f3T.js";import"./CHHb5WZe.js";import"./CeJbzRjl.js";import"./BaNg8fjw.js";import"./CfxLE1oh.js";import"./Bu7cOM_l.js";const ge={class:"ai-chat dark:bg-muted/50 flex h-full min-h-0 items-center justify-center pl-0"},ve={class:"bg-background flex h-full min-h-0 flex-1 flex-col items-center justify-center rounded-lg"},ye={class:"flex h-full w-full max-w-[800px] flex-col items-center justify-center"},xe={class:"mb-8 text-center"},Ce={class:"mb-2 flex items-center justify-center text-2xl font-bold"},Se={class:"text-accent-foreground text-sm"},Ie={class:"w-full px-4"},ke={key:0,class:"my-4 flex w-full flex-wrap justify-center gap-3"},we={class:"mr-1"},Me={class:"w-full p-2 text-center text-xs text-gray-400"},be={class:"flex flex-col items-center justify-center gap-1"},Ve={class:"flex items-center justify-center gap-2"},Ue=["href"],Ae={key:0},bt=H({__name:"index",async setup(Ne){let f,z;const c=W(),{t:Q}=X(),w=he(),T=O(),m=C(()=>w.selectedModel?.id||""),M=p(""),n=p([]),_=p(!1),r=p(),h=p(),g=p([]),{data:v}=([f,z]=ee(()=>ae("chat-config",()=>fe())),f=await f,z(),f),q=C(()=>v.value?.suggestionsEnabled??!0),D=C(()=>v.value?.suggestions||[]),b=C(()=>v.value?.welcomeInfo||{});function E(t){g.value=t}function V(){try{const t=JSON.parse(localStorage.getItem("mcpIds")||"[]");return Array.isArray(t)?t:[]}catch{return[]}}function L(t){t.length?localStorage.setItem("mcpIds",JSON.stringify(t)):localStorage.removeItem("mcpIds")}const P=async()=>{try{const t=await de();if(!t)return;r.value=t,h.value=t.id,_.value=V().includes(h.value||"")}catch(t){console.error("Failed to fetch quick menu:",t)}};async function B(t){try{if(!m.value&&le().isLogin){ce().warning(Q("ai-chat.frontend.selectModel"));return}const o=await _e({title:""});T.setPendingConversation({id:o.id,modelId:m.value,title:t,files:g.value.length>0?g.value:void 0}),me("chats"),await ue({path:`/chat/${o.id}`})}catch(o){console.error("Failed to create conversation:",o)}}const R=()=>{if(!h.value)return;Array.isArray(n.value)||(n.value=[]);const t=V(),o=h.value,U=t.includes(o),y=n.value.includes(o);if(!U&&!y)t.push(o),y||n.value.push(o),L(t);else{const A=t.filter(u=>u!==o),x=n.value.filter(u=>u!==o);L(A),n.value=x}_.value=V().includes(o)};return te(()=>{P()}),(t,o)=>{const U=K,y=Y,A=Z,x=ne,u=ie,G=pe;return i(),S("div",ge,[s("div",{class:F(["border-border/50 h-full flex-none border-r pl-0 sm:pl-2",{"border-none":!e(w).chatSidebarVisible}])},[I(U)],2),s("div",ve,[s("div",ye,[s("div",xe,[s("h1",Ce,l(e(b).title),1),s("p",Se,l(e(b).description),1)]),s("div",Ie,[I(G,{class:"[view-transition-name:chat-prompt]",modelValue:e(M),"onUpdate:modelValue":o[2]||(o[2]=a=>j(M)?M.value=a:null),"file-list":e(g),rows:2,needAuth:!0,attachmentSizeLimit:e(v)?.attachmentSizeLimit,onSubmit:B,"onUpdate:fileList":E},{"panel-left":N(()=>[I(y,{modelValue:e(m),"onUpdate:modelValue":o[0]||(o[0]=a=>j(m)?m.value=a:null),modelId:e(m)||"",supportedModelTypes:["llm"],"show-billingRule":!0,"open-local-storage":!0,placeholder:"选择AI模型开始对话",onChange:e(w).setSelectedModel},null,8,["modelValue","modelId","onChange"]),I(A,{modelValue:e(n),"onUpdate:modelValue":o[1]||(o[1]=a=>j(n)?n.value=a:null),mcpIds:e(n)||[],placeholder:"选择MCP..."},null,8,["modelValue","mcpIds"]),e(r)?(i(),k(u,{key:0,color:e(_)?"primary":"neutral",variant:"ghost",icon:e(r)?.icon?"":"tabler:tool",ui:{leadingIcon:"size-4"},class:F({"bg-primary/10":e(_)}),onClick:re(R,["stop"])},{default:N(()=>[e(r)?.icon?(i(),k(x,{key:0,src:e(r)?.icon,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),$(" "+l(e(r)?.alias||e(r)?.name),1)]),_:1},8,["color","icon","class"])):d("",!0)]),_:1},8,["modelValue","file-list","attachmentSizeLimit"])]),e(q)?(i(),S("div",ke,[(i(!0),S(oe,null,se(e(D),(a,J)=>(i(),k(u,{key:J,variant:"outline",color:"neutral",size:"md",onClick:je=>B(a.text)},{default:N(()=>[s("span",we,l(a.icon),1),$(" "+l(a.text),1)]),_:2},1032,["onClick"]))),128))])):d("",!0)]),s("div",Me,[s("div",be,[s("span",null,l(e(b).footer),1),s("div",Ve,[s("a",{href:e(c).siteConfig?.copyright.url,target:"_blank",rel:"noopener noreferrer",class:"hover:text-primary flex items-center justify-center gap-1 transition-colors"},[e(c).siteConfig?.copyright.iconUrl?(i(),k(x,{key:0,src:e(c).siteConfig?.copyright.iconUrl,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),s("span",null,l(e(c).siteConfig?.copyright.displayName),1)],8,Ue),e(c).siteConfig?.copyright.displayName||e(c).siteConfig?.copyright.iconUrl?(i(),S("span",Ae,"|")):d("",!0)])])])])])}}});export{bt as default};
