**详细 PRD**

---

# 一、文档信息

* **项目名称**：AI 智能日程助手
* **版本**：v1.0
* **负责人**：产品经理 XXX
* **相关角色**：后端、前端、AI 工程、测试、运营

---

# 二、产品概述

## 2.1 背景

现有日程/日历应用中，用户需要手动填写标题、时间、地点等字段，操作成本高，对“懒人用户”和“事务繁多用户”不友好。
本项目希望通过引入 AI 对话能力，让用户可以用自然语言描述需求，例如：

* 「帮我安排明天下午跟小王开个会，1 个小时」
* 「把今晚的健身改到周六早上」
* 「把这周所有 18 点后的会议往后顺延半小时」

系统通过 AI 解析意图，给出清晰的日程管理建议（新建、迁移、修改、删除等），并在前端以可点击的卡片形式展示。用户点击确认后，系统自动执行对应日程操作。

## 2.2 目标

* 降低用户创建/管理日程的门槛
* 提高日程创建与调整的效率
* 提升用户对产品“智能感”和“贴心感”的认知

---

# 三、目标与指标（KPI）

1. **功能使用率**

   * 日活用户中，有 ≥10% 用户使用 AI 日程助手入口
2. **人均操作效率**

   * 通过 AI 创建/修改日程的平均操作时长 < 20 秒
3. **日程管理完成率**

   * AI 提示卡片被用户点击“执行”的比例 ≥ 60%
4. **用户满意度（后期）**

   * 问卷/评分中，AI 功能满意度 ≥ 4.3 / 5

---

# 四、用户与场景

## 4.1 目标用户

* 日程较多的职场用户（会议多、任务多）
* 需要跨天规划的学生、自由职业者
* 偏好“说一句话就搞定”的懒人用户

## 4.2 典型使用场景

1. **快速创建日程**

   * 用户打开 AI 对话框，说：「周五下午帮我安排个牙医预约，提醒我提前一天。」
   * AI 自动解析时间、主题、提醒时间，生成一条“新建日程”卡片。

2. **调整已有日程**

   * 用户：「把明天下午的项目会议往后延 1 小时。」
   * AI 找到对应会议，生成“迁移日程”建议，显示新旧时间对比。

3. **批量管理**

   * 用户：「这周所有健身计划都改到晚上 8 点。」
   * AI 识别多个相关日程，给出“批量变更”建议。

4. **查询与建议**

   * 用户：「我下周三下午有空档吗？帮我安排 2 小时写报告。」
   * AI 查看日历空档，给出 1~2 个候选时段的方案卡片。

---

# 五、功能需求

## 5.1 功能结构概览

1. AI 日程入口
2. AI 对话界面
3. AI 意图解析 & 推荐方案生成
4. 前端方案展示（卡片）
5. 用户点击后的日程实际操作（新建/迁移/修改/删除/查询）
6. 操作结果反馈与撤销

---

## 5.2 入口与权限

### 5.2.1 功能入口

* 日历主界面固定入口按钮：

  * 文案示例：「AI 管理日程」「和 AI 安排」
* 日程详情页扩展入口（后期）：

  * 文案示例：「让 AI 帮我改时间」

### 5.2.2 权限

* 首次使用时弹出授权：

  * 读取用户日程
  * 创建/编辑/删除用户日程
* 授权文案需明确说明：

  * 仅用于 AI 分析和操作日程
  * 不对外共享

---

## 5.3 AI 对话能力

### 5.3.1 对话基本要求

* 支持多轮对话：用户可以补充信息、不满意时让 AI 修改方案
* 支持中文自然语言输入（后续可扩展英文/日文）

### 5.3.2 意图识别（核心）

AI 需从用户文本中识别以下信息：

1. **操作类型（intent）**

   * 创建日程：create_event
   * 修改日程：update_event
   * 迁移（改时间 / 改日期）：reschedule_event
   * 删除日程：delete_event
   * 批量操作：batch_update / batch_delete
   * 查询空档时间：query_free_time
   * 仅生成建议，不执行：suggest_plan（后期）

2. **必需参数（slots）**

   * 标题（title）
   * 时间（具体时间 / 日期、开始结束时间 / 时长）
   * 日期范围（批量操作时）
   * 相关日程（根据关键字从现有日程匹配）
   * 地点（可选）
   * 参与人（可选）
   * 提醒时间（可选）
   * 重复规则（可选：每天/每周/工作日等）

### 5.3.3 不确定情况处理

* 当 AI 无法确定具体时间 / 日程对象时：

  * 必须向用户追问确认（例：「你说的‘明天的会议’是指 10:00 的项目会，还是 15:00 的部门会？」）
* 当存在多个可能匹配：

  * 以前端列表形式展示候选项，让用户点选后再执行。

---

## 5.4 日程推荐方案生成

### 5.4.1 方案生成规则

AI 解析用户意图后，返回“结构化方案”给前端 / 后端，例如：

```json
{
  "intent": "create_event",
  "summary": "创建一个牙医预约",
  "event": {
    "title": "牙医预约",
    "start_time": "2025-11-23T15:00:00",
    "end_time": "2025-11-23T16:00:00",
    "reminder": "2025-11-22T15:00:00",
    "location": "XX牙科",
    "note": "用户口述：周日下午帮我安排牙医"
  }
}
```

### 5.4.2 前端展示形式

* 每个方案以**卡片**形式展示：

  * 顶部：说明文案（如「新建日程」/「修改日程」）
  * 标题：日程标题（例：牙医预约）
  * 主体：时间、地点、提醒、参与人等核心信息
  * 底部：按钮

    * 「确认执行」
    * 「修改」→ 打开编辑面板（手动改）或让 AI 再生成
* 若是批量操作：

  * 卡片内显示操作范围说明：「本周 3 条健身计划将从 18:00 调整为 20:00」

---

## 5.5 日程管理动作（后端执行）

### 5.5.1 新建日程（Create）

* 接口入参示例：

  * title, start_time, end_time, location, reminder, repeat_rule, note
* 约束：

  * start_time < end_time
  * 若用户不填结束时间，可按默认时长（如 30/60 分钟）

### 5.5.2 修改 / 迁移日程（Update / Reschedule）

* 场景：

  * 修改时间
  * 修改标题、地点、备注
  * 修改提醒时间
* 需要先找到“目标日程”：

  * 根据 event_id（如果 AI 直接返回）
  * 或通过标题 + 时间范围模糊匹配，若多条则让用户选

### 5.5.3 删除日程（Delete）

* 显示二次确认：

  * 「确定删除该日程吗？」
  * 若是系列重复事件，则需区分：

    * 删除这一个
    * 删除这之后的所有
    * 删除全部重复事件（后期）

### 5.5.4 批量操作（Batch）

* 支持：

  * 批量时间调整
  * 批量删除某类标签/标题的事件
* 卡片需清晰提示影响范围（数量 + 日期区间）

---

## 5.6 操作结果与撤销

### 5.6.1 操作结果反馈

* 成功：

  * Toast：「已为你创建日程：牙医预约（11/23 15:00-16:00）」
  * AI 对话中追加一句简短回执：「搞定啦～已经帮你加到周日 3 点哦。」
* 失败：

  * 提示失败原因（网络错误 / 日历服务异常 / 参数错误等）

### 5.6.2 撤销（Undo）

* 每次对日程的“变更动作”应支持短时间内撤销

  * 弹出条：「已修改会议时间。撤销」
  * 撤销时根据日志恢复原日程状态

---

# 六、交互流程（文字描述）

## 6.1 创建日程主流程

1. 用户点击「AI 管理日程」按钮
2. 打开对话窗，用户输入：「明天下午帮我安排个和小王的项目会议，1 小时」
3. AI 解析出：

   * intent: create_event
   * 时间：明天下午（例如 15:00-16:00）
   * 标题：项目会议（可以加小王）
4. AI 返回方案卡片：

   * 标题：项目会议 - 小王
   * 时间：XX 月 XX 日 15:00-16:00
   * 提醒：默认提前 10 分钟
   * 按钮：[确认创建] [修改]
5. 用户点击「确认创建」
6. 系统调用日程创建接口
7. 返回成功提示 & AI 对话中反馈

## 6.2 迁移日程流程

1. 用户输入：「把明天 10 点的产品评审会改到下午 3 点。」
2. AI 在日历中查找：

   * 日期：明天
   * 标题中包含「产品评审会」且时间为 10:00
3. 生成方案：

   * 旧时间：10:00-11:00
   * 新时间：15:00-16:00
   * 卡片按钮：[确认调整] [修改目标]
4. 用户确认 → 调用更新接口 → 成功提示 & 可撤销按钮

---

# 七、界面与交互要求（前端）

## 7.1 对话框

* 形式：底部弹出 / 全屏（视具体产品而定）
* 结构：

  * 顶部：标题「AI 日程助手」+ 关闭按钮
  * 主体：对话记录 + AI 卡片
  * 底部：输入框 + 发送按钮

## 7.2 卡片样式（建议）

* 卡片标题行：

  * 操作类型标签（例如「新建」「修改」「迁移」「批量修改」）
* 内容区：

  * 日程标题（加粗）
  * 时间 & 日期
  * 其他信息（地点 / 提醒 / 重复）
* 底部按钮：

  * 主按钮：执行操作
  * 次按钮：修改 / 取消

---

# 八、文案示例（可调整）

* 首次进入引导：

  * 「用自然语言描述你的计划，我来帮你安排日程～」
* 解析成功：

  * 「我这样理解对吗？👇」
* 需要确认多个日程时：

  * 「我找到了 2 个可能的会议，你说的是哪一个？」
* 操作成功：

  * 「搞定！已经帮你加到日历里啦～」

---

# 九、技术方案概述（简版）

## 9.1 系统构成

1. 前端：

   * 展示对话界面与卡片
   * 收集用户输入 / 操作点击
2. 后端服务：

   * 接收用户自然语言 + 当前上下文
   * 调用 LLM 模块解析意图
   * 根据解析结果构造结构化方案
   * 负责真正落地到日历服务（创建/修改/删除等）
3. AI 模块：

   * LLM（大模型） + 规则引擎
   * 封装为统一接口：`/ai_schedule/parse`

## 9.2 数据格式约定（示例）

* 请求：

  * 用户自然语言、当前时间、当前日历数据概要（可选）
* 响应：

  * intent
  * 置信度
  * 结构化日程列表（可能多个方案）

---

# 十、埋点 & 数据统计

建议埋点维度：

1. 入口点击次数
2. 对话请求次数
3. AI 解析成功率（能生成结构化方案）
4. 每种意图的分布（create/update/reschedule/delete/query）
5. 卡片“执行”按钮点击率
6. 撤销次数
7. 错误率（后端/AI/日历接口）

---

# 十一、风险与边界

1. **解析错误风险**

   * 解决：低置信度时要求用户确认 / 多问几句
2. **误操作风险（改错 / 删错）**

   * 解决：二次确认 + 撤销能力
3. **时间解析歧义**

   * 例如“下周”、“下午”，需清晰本地时区 & 当前日期的规则
4. **隐私与安全**

   * 明确告知数据用途
   * 不用于广告或对外分享

---

